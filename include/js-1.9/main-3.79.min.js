function updateStickyStyle(){var e=selectedTab.newPanel[0].id,t=0,a=$("#"+e),n=$("#defaultForm-"+e).height();a.find(".form-button-panel").each(function(){butttonPanelHeight=parseInt($(this).outerHeight()),t=parseInt($(this).position().top),n-butttonPanelHeight+50<t?$(this).removeClass("sticky"):$(this).addClass("sticky")})}function updateControlLabelPadding(){$(".control-label").each(function(){var e=$(this).height()>_CONTROL_LABEL_HEIGHT_?0:"7px";$(this).css("padding-top",e)})}function adjustActionBarWidth(){$(".panel-data-list .container").each(function(){var e=$(this).find(".action-bar-fixed.fixed"),t=0;if(e.length>0){parseFloat($(this).width())>0&&e.width($(this).width()),(t=parseFloat(e.height()))>0&&(t+=5)}else $(this).find(".action-bar-fixed").css("width","auto");$(this).find(".data-list-margin").height(t)})}function adjustActionBarPosition(){$(".action-bar-fixed.fixed").each(function(){var e=$(window).scrollLeft(),t=$(this).closest(".container").offset().left;$(this).css("left",t-e)})}function mnvPushPopUpNotification(e,t){t||(t="");var a=$("#mnv-popup-notification").find(".template"),n=a.clone().removeClass("template").addClass(t).insertBefore(a.first());n.find(".content").html(e),n.find(".close-icon").bind("click",function(e){var t=$(this).closest(".list");t.fadeOut(500,function(){t.remove()})}),n.show(),mnvUpdateNotificationSettings()}function mnvUpdateNotificationSettings(){var e=$("#mnv-popup-notification");e.find(".list").length>2?e.find(".close-all").show():e.find(".close-all").hide()}function editTagList(e){$("#tag-filter .save-tag-button, #tag-filter .edit-tag-button, #tag-filter .tag-input, #tag-filter .tag-list").toggle()}function saveTagList(e){$("#tag-filter .save-tag-button, #tag-filter .edit-tag-button, #tag-filter .tag-input, #tag-filter .tag-list").toggle();var t=$(e).closest("form");$.ajax({type:"POST",url:"ajax-tag.php",data:t.serialize(),dataType:"json"}),updateData(!1)}function setOnDocumentReady(e,t){void 0!=t&&(tabParam[e].obj=t),$("#"+e+" #defaultForm").attr("id","defaultForm-"+e),$("#"+e+" [name=btnSave]").is(":visible")||disableFormSaveOnEnter($("#defaultForm-"+e)),$("#"+e+" [name=btnSaveAndProceed]").click(function(){$("#"+e+" [name=hidSaveAndProceed]").val(1)}),$("#"+e+" [name=btnSave]").click(function(){$("#"+e+" [name=hidSaveAndProceed]").val(0)}),$("#"+e+" .remove-button").click(function(){removeDetailRows(this)}),$("#"+e+" .input-integer").each(function(){""==$(this).val()&&$(this).val(0)}).bind("blur",function(e){inputNumberOnBlur($(this),0)}),$("#"+e+" .inputnumber").each(function(){""==$(this).val()&&$(this).val(0)}).bind("blur",function(e){inputNumberOnBlur($(this))}),$("#"+e+" .inputdecimal").each(function(){""==$(this).val()&&$(this).val(0)}).bind("blur",function(e){inputNumberOnBlur($(this),2)}),$("#"+e).find(".inputnumber, .inputdecimal, .input-integer").bind("focus",function(e){inputNumberOnFocus($(this))}),$("#"+e+" .input-date").datepicker({showButtonPanel:!0,currentText:"Now",dateFormat:"dd / mm / yy",changeMonth:!0,changeYear:!0}),$("#"+e+" .input-datetime").datetimepicker({currentText:"Now",dateFormat:"dd / mm / yy",changeMonth:!0,changeYear:!0}),$("#"+e+" .input-month").datepicker({dateFormat:"MM yy",changeMonth:!0,changeYear:!0,showButtonPanel:!0,onClose:function(e,t){if($("#ui-datepicker-div").html().indexOf("ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all ui-state-hover")>-1){var a=$("#ui-datepicker-div .ui-datepicker-month :selected").val(),n=$("#ui-datepicker-div .ui-datepicker-year :selected").val();$(this).datepicker("setDate",new Date(n,a,1)).trigger("change"),$(".input-month").focusout()}},beforeShow:function(e,t){if(t.dpDiv.addClass("month-year-datepicker"),(datestr=$(this).val()).length>0){var a=new Date(datestr);year=a.getFullYear(),month=a.getMonth(),$(this).datepicker("option","defaultDate",new Date(year,month,1)),$(this).datepicker("setDate",new Date(year,month,1))}}}),$("#"+e).find("select[readonly]").find("option:not(:selected)").attr("disabled",!0),$("#"+e+" .mnv-barcode-input").keydown(function(e){barcodeHandler(this,e)}),updateRowNumber($("#"+e+" .transaction-detail")),$(".mnv-total-group-detail").hide(),$(".mnv-total-field").focus(function(){$(this).closest("div").find(".collapsible-icon").hide(),$(this).closest(".mnv-total-group").find(".mnv-total-group-detail").slideDown()}),$(".mnv-total-group-hide-detail").click(function(){var e=$(this).closest(".mnv-total-group");e.find(".mnv-total-group-detail").slideUp(),e.find(".collapsible-icon").show()}),updateStickyStyle(),bindFormPaging(e)}function prepareHandler(e){var t=e.tabID,a=$("#"+t);tabParam[t]||(tabParam[t]={href:"",tabID:t}),tabParam[t].obj=e,a.find("#defaultForm").attr("id","defaultForm-"+t),a.find("[name=btnSave]").is(":visible")||disableFormSaveOnEnter($("#defaultForm-"+t)),a.find("[name=btnSaveAndProceed]").click(function(){a.find("[name=hidSaveAndProceed]").val(1)}),a.find("[name=btnSave]").click(function(){a.find("[name=hidSaveAndProceed]").val(0)}),a.find(".remove-button").click(function(){removeDetailRows(this),getTabObj()&&$.isFunction(getTabObj().afterRemoveRowHandler)&&getTabObj().afterRemoveRowHandler()}),a.find(".add-row-button").unbind("click").bind("click",function(t){$row=addNewTemplateRow($(this).attr("attr-template"),null,$(this).closest(".transaction-detail"),e.rebindEl,$(this).closest(".transaction-detail-row")),$.isFunction(getTabObj().afterAddNewTemplateRowHandler)&&getTabObj().afterAddNewTemplateRowHandler($row)}),a.find(".input-integer").each(function(){""==$(this).val()&&$(this).val(0)}).bind("blur",function(e){inputNumberOnBlur($(this),0)}),a.find(".inputnumber").each(function(){""==$(this).val()&&$(this).val(0)}).bind("blur",function(e){inputNumberOnBlur($(this))}),a.find(".inputdecimal").each(function(){""==$(this).val()&&$(this).val(0)}).bind("blur",function(e){inputNumberOnBlur($(this),2)}),a.find(".inputautodecimal").each(function(){""==$(this).val()&&$(this).val(0)}).bind("blur",function(e){inputNumberOnBlur($(this),-2)}),a.find(".inputnumber, .inputdecimal, .input-integer, .inputautodecimal").bind("focus",function(e){inputNumberOnFocus($(this))}),a.find(".input-date").datepicker({showButtonPanel:!0,currentText:"Now",dateFormat:"dd / mm / yy",changeMonth:!0,changeYear:!0}).keyup(function(e){$(this).attr("attr-allow-empty")&&(8!=e.keyCode&&46!=e.keyCode||$.datepicker._clearDate(this))}),a.find(".input-datetime").datetimepicker({currentText:"Now",dateFormat:"dd / mm / yy",changeMonth:!0,changeYear:!0}).keyup(function(e){$(this).attr("attr-allow-empty")&&(8!=e.keyCode&&46!=e.keyCode||$(this).val(""))}),a.find(".input-date, .input-datetime").each(function(){var e=$(this).attr("max-days")||0;e>0&&$(this).datepicker("option","maxDate","+"+e+"D")}),a.find(".input-month").datepicker({dateFormat:"MM yy",changeMonth:!0,changeYear:!0,showButtonPanel:!0,onClose:function(e,t){if($("#ui-datepicker-div").html().indexOf("ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all ui-state-hover")>-1){var a=$("#ui-datepicker-div .ui-datepicker-month :selected").val(),n=$("#ui-datepicker-div .ui-datepicker-year :selected").val();$(this).datepicker("setDate",new Date(n,a,1)).trigger("change"),$(".input-month").focusout()}},beforeShow:function(e,t){if(t.dpDiv.addClass("month-year-datepicker"),(datestr=$(this).val()).length>0){var a=new Date(datestr);year=a.getFullYear(),month=a.getMonth(),$(this).datepicker("option","defaultDate",new Date(year,month,1)),$(this).datepicker("setDate",new Date(year,month,1))}}}),a.find(".multi-selectbox:not(:disabled)").searchableOptionList({maxHeight:"250px",showSelectAll:!0,showSelectionBelowList:!0}),a.find("select[readonly]").find("option:not(:selected)").attr("disabled",!0),a.find(".mnv-barcode-input").keydown(function(e){barcodeHandler(this,e)}),updateRowNumber(a.find(".transaction-detail")),a.find("[name=btnAddRows]").on("click",function(){addNewTemplateRow("detail-row-template",null,null,e.rebindEl)});var n=a.find(".mnv-transaction");0!=n.length&&0==n.find(".transaction-detail-row").length&&addNewTemplateRow("detail-row-template",null,null,e.rebindEl);var i=a.find(".mnv-payment-method");addNewTemplateRow("payment-method-row-template"),bindEl(i.find(".mnv-detail-field"),"change",function(){onChangePaymentMethodHandler(e,i)}),bindEl(i.find(".remove-button"),"click",function(){removeDetailRows(this),onChangePaymentMethodHandler(e,i)}),a.find(".mnv-currency .input-currency").on("change",function(){onChangeCurrency(this)}),a.find(".mnv-currency .input-currency").change(),$(".mnv-total-group-detail").hide(),$(".mnv-total-field").focus(function(){$(this).closest("div").find(".collapsible-icon").hide(),$(this).closest(".mnv-total-group").find(".mnv-total-group-detail").slideDown()}),$(".mnv-total-group-hide-detail").click(function(){var e=$(this).closest(".mnv-total-group");e.find(".mnv-total-group-detail").slideUp(),e.find(".collapsible-icon").show()}),updateControlLabelPadding(),removeButtonPanelIfEmpty(t),updateStickyStyle(),bindFormPaging(t),e.loadOnReady()}function removeButtonPanelIfEmpty(e){0==$("#"+e+" .form-button-panel button, #"+e+" .form-button-panel .next-page, #"+e+" .form-button-panel .prev-page").length&&$("#"+e+" .form-button-panel").hide()}function bindFormPaging(e){$(".next-page, .prev-page").on("click",function(){$("#"+e+" .form-button-panel button").attr("disabled",!0),$("#"+e+" .next-page").unbind("click").addClass("next-page-muted").removeClass("next-page"),$("#"+e+" .prev-page").unbind("click").addClass("prev-page-muted").removeClass("prev-page");var t=tabParam[e].href,a=$("[name=hidId]").val()||0,n=$(this).attr("attr-pkey");0!=a&&(t=t.replace("id="+a,"id="+n),tabParam[e].href=t,$("#"+e).load(encodeURI(t)))})}function onChangePaymentMethodHandler(e,t,a){var n=t.find(".mnv-detail-field"),i=0;n.each(function(){i+=parseFloat(unformatCurrency($(this).val()))||0}),t.find(".mnv-total-field").val(i).blur(),a||(a="payment-method-row-template");var l=autoAddNewRowTemplate(n,a);l&&(bindEl(l.find(".mnv-detail-field"),"change",function(){onChangePaymentMethodHandler(e,t,a)}),bindEl(l.find(".remove-button"),"click",function(){removeDetailRows(this),onChangePaymentMethodHandler(e,t,a)})),e.onChangePaymentMethodHandler&&e.onChangePaymentMethodHandler()}function setFormValidation(e,t,a,n){t.bootstrapValidator({feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:a}).on("success.form.bv",function(t){submitForm(t,{tabID:e.tabID},{parentPanelId:n.parentPanelId,parentTitle:n.parentTitle,autoPrintURL:n.autoPrintURL},{value:n.value,valueDBField:n.valueDBField,key:n.key,revalidateField:n.revalidateField})})}function autoAddNewRowTemplate(e,t,a){var n=!1;if(e.each(function(){return!$(this).closest(".div-table-row").hasClass(t)&&(value=parseInt(unformatCurrency($(this).val()))||0,0==value?(n=!0,!1):void 0)}),!n){var i=addNewTemplateRow(t);return a&&bindAutoCompleteForTransactionDetail(a.object,a.objAndvalueDetailForAutoComplete,a.url),i}}function bindEl(e,t,a){e.unbind(t).on(t,a)}function bindSelectableDataRecord(e){e.find(".selectable").selectable({filter:"li",cancel:".unselectable, .data-card",stop:function(){resetSelectedRows(),$(".ui-selected",this).each(function(){selectMultiRows($(this).closest(".data-record"))})}})}function setAutoComplete(e,t,a){var n=t.objName,i=t.objValue,l=t.url;void 0==a&&(a=!0),$("#"+e+" [name="+n+"]").autocomplete({source:l,minLength:1,autoFocus:!0,select:function(t,a){$("#"+e+" [name="+i+"]").val(a.item.pkey)},search:function(e,t){},change:function(e,t){a&&null==t.item&&clearAutoCompleteInput(this,i)}}).change(function(){a&&""==$(this).val()&&clearAutoCompleteInput(this,i)})}function getSelectedTabIndex(){return $("#tabs").tabs("option","active")}function findTabIndexByTitle(e){var t=0,a=!1;return $("#tabs ul li a").each(function(n){if(0==this.text.localeCompare(e))return a=!0,!1;t++}),a?t:-1}function addTab(e,t,a,n){e=decodeURI(e),tabNameExists=!1;var i=-1;if(n&&(i=findTabIndexByTitle(e)),-1!=i)$tabs.tabs("option","active",i),adjustActionBarPosition();else{var l="";void 0!=a&&1!=a||(l='<span class="ui-icon ui-icon-close" role"presentation"></span>'),$('<li attr-href="'+t+"\"><a href='"+t+"'>"+e+"</a>"+l+"</li>").appendTo("#tabs .ui-tabs-nav"),$tabs.tabs("refresh"),$tabs.tabs("option","active",$("#tabs ul:first li").length-1),tabParam[selectedTab.newPanel[0].id]={title:e,href:t,phpDataListFile:"",addDataFile:"",selectedPkey:[],quickView:[],lastRowIndex:0,filterCriteria:[],tagInformation:[],selectedCriteriaTagKey:[],orderby:"",ordertype:"",isTransaction:!1,tablekey:0}}}function openTabForEdit(){var e=tabParam[selectedTab.newPanel[0].id].selectedPkey;if(0!=e.length){dataPkeyCol=JSON.stringify(e),dataPkey=e[0];var t=selectedTab.newTab[0].textContent,a=selectedTab.newPanel[0].id,n=tabParam[a].phpDataListFile,i=tabParam[a].addDataFile;-1==i.indexOf("?")?i+="?":i+="&";addTab('<i class="far fa-edit title-icon"></i>'+t,i+"title="+t+"&id="+dataPkey+"&idcol="+dataPkeyCol+"&fileName="+n+"&selectedPanelId="+a)}else showMsgDialog("Anda belum memilih data yang hendak diubah.")}function bindAutoCompleteForTransactionDetail(targetObj,objAndValue,searchFile,handlingFunction){var objTarget=$("#"+selectedTab.newPanel[0].id+" [name='"+targetObj+"']"),onSelectFunction="",onChangeFunction="";$.isArray(handlingFunction)?(onSelectFunction=handlingFunction.onSelectFunction,onChangeFunction=handlingFunction.onChangeFunction):onSelectFunction=handlingFunction,objTarget.autocomplete({source:searchFile,autoFocus:!0,minLength:1,open:function(e,t){$(this).attr("isbarcode")&&($(this).attr("isbarcode",0),$(this).data("ui-autocomplete").menu.element.children().first().click(),$(this).closest("div").next().find("input").focus())},select:function(event,ui){if(void 0!=onSelectFunction&&""!=onSelectFunction)"string"==jQuery.type(onSelectFunction)?eval(onSelectFunction+"(this,objAndValue,ui)"):onSelectFunction(this,objAndValue,ui),event.preventDefault();else{var tableRow=$(this).closest(".div-table-row");for(i=0;i<objAndValue.length;i++){var elObj=tableRow.find("[name='"+objAndValue[i].object+"']").first(),elVal=ui.item[objAndValue[i].value];"date"==objAndValue[i].type&&(elVal=moment(elVal).format(_DATE_FORMAT_)),elObj.val(elVal).change()}tableRow.find(".inputnumber, .inputdecimal, .inputautodecimal").blur()}},search:function(e,t){},change:function(event,ui){var nextInput=$(this).closest("div").next().find("input"),chkPick=$(this).closest(".div-table-row").find("[name='chkPick[]']");if(null==ui.item){for(chkPick.prop("checked",!1),i=0;i<objAndValue.length;i++)$(this).closest(".div-table-row").find("[name='"+objAndValue[i].object+"']").first().val("").blur();$(this).val("").change()}else chkPick.prop("checked",!0);chkPick.change(),void 0!=onChangeFunction&&""!=onChangeFunction&&eval(onChangeFunction+"(this,objAndValue,ui)"),nextInput.focus()}})}function clearAutoCompleteInput(e,t,a){$(e).val(""),"string"==jQuery.type(t)?$(e).closest("form").find("[name='"+t+"']").first().val(""):t.val(""),void 0==a&&(a=!0),a&&$(e).closest("form").bootstrapValidator("revalidateField",$(e).attr("name"))}function updateTagStatusPanel(){var e=tabParam[selectedTab.newPanel[0].id].tagInformation;if(e){var t="",a='checked="checked"';for(i=0;i<e.length;i++){t+='<div class="div-table-row tag-list">';var n="",l="",o="";jQuery.inArray(e[i].tagPkey,tabParam[selectedTab.newPanel[0].id].selectedCriteriaTagKey)>=0?(n='checked="checked"',l="text-white",o="background-color:"+e[i].hexColor):a="",t+='<div class="div-table-col div-table-col-header" ><label class="'+l+'" style="'+o+'"><input name="chk-group-tag-filter[]"  type="checkbox" '+n+' class="chk-group-filter" group="selectedCriteriaTagKey" value="'+e[i].tagPkey+'">'+e[i].tagName+'<div class="total-status" style="background-color:'+e[i].hexColor+'">'+e[i].totalData+"</div></label></div>",t+="</div>",t+='<div  style="display:none;" class="div-table-row tag-input">',t+='<div class="div-table-col" style="padding 0.3em 0"><div  style="padding:0.5em; border-radius:0.5em; background-color:'+e[i].hexColor+'"><input name="name[]" class="form-control input-01" autocomplete="off" value="'+e[i].tagName+'" type="text" ></div><input name="hidTagDetailKey[]" value="'+e[i].pkey+'" type="hidden"></div>',t+="</div>"}return t+="</div>",t='<div id="tag-filter" class="div-table-status-information" ><div class="div-table-caption"><input name="chk-group-filter-tag-master[]"  type="checkbox"  class="chk-group-filter"  '+a+" ></input> "+phpLang.tag.toUpperCase()+' <div class="manage-button edit-tag-button" style="float:right" onClick="editTagList(this)">'+phpLang.edit.toLowerCase()+'</div><div class="manage-button save-tag-button" style="float:right; display:none" onClick="saveTagList(this)">'+phpLang.save.toLowerCase()+"</div></div>"+t,t='<form><input name="action" value="update" type="hidden">'+t+"</form>"}}function updateStatusPanel(){if($("#left-status-panel").html(""),void 0!=tabParam[selectedTab.newPanel[0].id]&&""!=tabParam[selectedTab.newPanel[0].id].phpDataListFile){var e=tabParam[selectedTab.newPanel[0].id].filterCriteria;if(e)for(var t=0;t<e.length;t++){var a=e[t],n=a.title,l=a.statusInformation,o=a.selectedCriteriaKey,r=(a.group,""),d=0,s='checked="checked"';for(i=0;i<l.length;i++){r+='<div class="div-table-row" >';var c="",u="";o&&jQuery.inArray(l[i].pkey,o)>=0?(c='checked="checked"',u="selected"):s="",r+='<div class="div-table-col div-table-col-header" ><label class="'+u+'"><input name="chk-group-filter[]"  type="checkbox" '+c+' class="chk-group-filter" group="'+t+'" value="'+l[i].pkey+'" >'+l[i].name+'<div class="total-status bg-blue-steel">'+l[i].totalData+"</div></label></div>",r+="</div>",d+=parseInt(l[i].totalData)}r+="</div>",r='<div class="div-table-status-information " style="margin-bottom:2em;"><div class="div-table-caption"><input name="chk-group-filter-master[]"  type="checkbox" class="chk-group-filter" '+s+' group="'+t+'" ></input> '+n.toUpperCase()+"</div>"+r;r=(0==t?'<div class="div-table-status-information" style="margin-bottom:1em; font-weight:bold;" ><div class="div-table-row " ><div class="div-table-col" style="color:#333; " >'+phpLang.totalData.toUpperCase()+'<div class="total-status" style="color:#333;" >'+d+"</div></div></div></div>":"")+r,$("#left-status-panel").append(r)}$("#left-status-panel").append(updateTagStatusPanel()),$("#left-status-panel .total-status").formatCurrency({roundToDecimalPlace:0}),$("#left-status-panel [name='chk-group-filter[]']").click(function(){var e=$(this).attr("group"),t=Array();$(this).closest(".div-table-status-information").find("[name='chk-group-filter[]']").each(function(){1==$(this).prop("checked")&&t.push($(this).val())}),tabParam[selectedTab.newPanel[0].id].filterCriteria[e].selectedCriteriaKey=t,updateData(!1)}),$("#left-status-panel [name='chk-group-tag-filter[]']").click(function(){var e=Array();$(this).closest(".div-table-status-information").find("[name='chk-group-tag-filter[]']").each(function(){1==$(this).prop("checked")&&e.push($(this).val())}),tabParam[selectedTab.newPanel[0].id].selectedCriteriaTagKey=e,updateData(!1)}),$("#left-status-panel [name='chk-group-filter-master[]']").change(function(){var e=$(this).attr("group"),t=$(this).prop("checked"),a=Array();$(this).closest(".div-table-status-information").find("[name='chk-group-filter[]']").each(function(){$(this).prop("checked",t),t&&a.push($(this).val())}),tabParam[selectedTab.newPanel[0].id].filterCriteria[e].selectedCriteriaKey=a,updateData(!1)}),$("#left-status-panel [name='chk-group-filter-tag-master[]']").change(function(){var e=$(this).prop("checked"),t=Array();$(this).closest(".div-table-status-information").find("[name='chk-group-tag-filter[]']").each(function(){$(this).prop("checked",e),e&&t.push($(this).val())}),tabParam[selectedTab.newPanel[0].id].selectedCriteriaTagKey=t,updateData(!1)})}}function unformatCurrency(e){return void 0==e?0:e.replace(/,/g,"")}function collapseAllMenu(){$("#menu ul li").each(function(e){$(this).removeClass("active").addClass("inactive")}),$(".submenu").each(function(e){$(this).hide()})}function selectAllRows(){var e=isMobile()?".mobile-selectable":".selectable";$("#"+selectedTab.newPanel[0].id+" "+e+" li").addClass("ui-selected"),$("#"+selectedTab.newPanel[0].id+" .data-record [name='chkRow[]']").prop("checked",!0);var t=Array();$(".ui-selected","#"+selectedTab.newPanel[0].id+" "+e).each(function(){t.push($(this).attr("relId"))}),tabParam[selectedTab.newPanel[0].id].selectedPkey=t,checkIsAllRowsSelected()}function deselectAllRows(){var e=isMobile()?".mobile-selectable":".selectable";$("#"+selectedTab.newPanel[0].id+" "+e+" li").removeClass("ui-selected"),$("#"+selectedTab.newPanel[0].id+" .data-record [name='chkRow[]']").prop("checked",!1),tabParam[selectedTab.newPanel[0].id].selectedPkey=Array(),checkIsAllRowsSelected()}function deselectRow(e,t){t||(t=selectedTab.newPanel[0].id),e.removeClass("ui-selected"),e.closest(".data-record").find("[name='chkRow[]']").prop("checked",!1),tabParam[t].selectedPkey=jQuery.grep(tabParam[t].selectedPkey,function(t){return t!=e.attr("relId")}),checkIsAllRowsSelected()}function selectRow(e){deselectAllRows(),e.addClass("ui-selected"),e.closest(".data-record").find("[name='chkRow[]']").prop("checked",!0);var t=Array();t.push(e.attr("relId")),tabParam[selectedTab.newPanel[0].id].selectedPkey=t,checkIsAllRowsSelected()}function selectMultiRows(e){e.addClass("ui-selected"),e.closest(".data-record").find("[name='chkRow[]']").prop("checked",!0),tabParam[selectedTab.newPanel[0].id].selectedPkey.push(e.attr("relId")),checkIsAllRowsSelected()}function resetSelectedRows(){$("#"+selectedTab.newPanel[0].id+" .data-record [name='chkRow[]']").prop("checked",!1),tabParam[selectedTab.newPanel[0].id].selectedPkey=Array()}function checkIsAllRowsSelected(){var e=$("#"+selectedTab.newPanel[0].id+" .data-record"),t=$("#"+selectedTab.newPanel[0].id+" .data-record [name='chkRow[]']:not(:checked)"),a=!(0==e.length||t.length>0);$("#"+selectedTab.newPanel[0].id+" [name='chkRow-master']").prop("checked",a)}function toggleAllSelectedDataDetail(e){selectedPkey=tabParam[selectedTab.newPanel[0].id].selectedPkey;var t=$("#"+selectedTab.newPanel[0].id+" .data-list ol .data-record");if(0==selectedPkey.length){var a=!0;t.find(".table-data-record-detail:visible").each(function(t){a=!1,toggleQuickView($(this).closest(".data-record"),e)}),a&&t.each(function(t){toggleQuickView($(this),e)})}else t.each(function(t){jQuery.inArray($(this).attr("relId"),selectedPkey)>=0&&toggleQuickView($(this),e)})}function toggleQuickView(e,t){if(0!=tabParam[selectedTab.newPanel[0].id].quickView){var a=e.attr("relId");phpDataListFile=tabParam[selectedTab.newPanel[0].id].phpDataListFile;var n=$("#"+selectedTab.newPanel[0].id+" .table-data-record-detail"+a);n.is(":visible")?void 0!=t&&1!=t||n.slideToggle():void 0!=t&&2!=t||$.ajax({type:"POST",url:phpDataListFile,data:"generateQuickView=1&id="+a,success:function(e){n.html(e)}}).done(function(e){""!=e&&n.slideToggle()})}}function updateData(e,t){deselectAllRows();var a="";void 0==t&&(t=selectedTab.newPanel[0].id),phpDataListFile=tabParam[t].phpDataListFile,targetContent=$("#"+t+" .data-list"),e?targetContent.find(".load-more:first").find(".loading-icon:first").show():($("html, body").animate({scrollTop:0},"fast"),targetContent.html(_LOADING_ICON_));var n=$("[name=quick-search-"+t+"]");void 0!=n.val()&&(a=$("[name=quick-search-"+t+"]").val()),$("[name=quick-search-"+t+"]").attr("reltype",0),n.closest("div").find(".clear-text-icon, .search-icon").hide(),n.closest("div").find(".loading-icon").show(),$.ajax({type:"POST",url:phpDataListFile,data:{generateDataRecords:1,quickSearchKey:a,page:$("[name=selPage-"+t+"]").val(),loadMoreTriggered:e,lastRowIndex:tabParam[t].lastRowIndex,filterCriteria:tabParam[t].filterCriteria,selectedCriteriaTagKey:tabParam[t].selectedCriteriaTagKey,orderby:tabParam[selectedTab.newPanel[0].id].orderby,ordertype:tabParam[selectedTab.newPanel[0].id].ordertype},success:function(a){var i=JSON.parse(a);if(tabParam[t].filterCriteria=i.filterCriteria,tabParam[t].tagInformation=i.tagInformation,tabParam[t].contextMenu=i.contextMenu,tabParam[t].contextMenuCallback=i.contextMenuCallback,tabParam[t].isTransaction=i.isTransaction,tabParam[t].transactionStatus=i.transactionStatus,e){var l='<div class="page-break">Page '+(Math.ceil(tabParam[t].lastRowIndex/phpConfiguration.adminTotalRowsPerPage)+1)+'</div><div style="clear:both;"></div>';l+=i.dataList,targetContent.find(".data-list-row:first").append($(l).hide().fadeIn())}else targetContent.hide().html(i.dataList).fadeIn();i.eof?targetContent.find(".load-more:first").hide():targetContent.find(".load-more:first").show();var o=targetContent.find(".load-more:first");o.find(".loading-icon:first").hide(),o.click(function(){$(this).unbind("click"),updateData(!0)}),tabParam[t].lastRowIndex=i.lastRowIndex,rebuildPaging($("[name=selPage-"+t+"]"),i.totalPages,i.selectedPageIndex),updateStatusPanel(),updateRightClick(),deselectAllRows(),n.closest("div").find(".loading-icon").hide(),""!=n.val()?n.closest("div").find(".clear-text-icon").show():n.closest("div").find(".search-icon").show()}})}function updateRightClick(){var contextItem=tabParam[selectedTab.newPanel[0].id].contextMenu,contextMenu=$.contextMenu({selector:"#"+selectedTab.newPanel[0].id+" .data-record",events:{show:function(e){tabParam[selectedTab.newPanel[0].id].selectedPkey.length<=1&&(deselectAllRows(),selectRow($(this).closest(".data-record")))}},callback:function(key,options){eval(tabParam[selectedTab.newPanel[0].id].contextMenuCallback)},items:contextItem})}function ajaxDeleteData(e,t){var a=$("#dialog-message").find("[name=txtDesc]").val();a=a?a.trim():"",$.ajax({type:"POST",url:t,data:{action:"delete",selectedPkey:e,description:a}}).done(function(e){var t=parseError(e);0==t.valid&&""!=t.errorMsg&&showMsgDialog(t.errorMsg,"Hapus Data Gagal"),updateData(!1)})}function deleteData(){var e=selectedTab.newPanel[0].id,t=tabParam[e].phpDataListFile,a=($("#"+e+" .data-list"),tabParam[e].selectedPkey),n=$("#dialog-message"),i=tabParam[e].isTransaction;if(0!=a.length){var l="Anda yakin akan menghapus data ini ?";i&&(l+='<div class="description"><div class="error-message"></div><textarea name="txtDesc" type="textarea" class="form-control" style="height:5em" placeholder="'+ucfirst(phpLang.cancelReason)+' ..."></textarea></div>'),n.html(l),n.dialog({width:300,height:"auto",modal:!0,close:function(){n.find(".error-message").html(""),n.val("")},title:"Konfirmasi Hapus Data"});var o=new Array;o.push({text:"OK",id:"OK",click:function(){var e=n.find("[name=txtDesc]").val();e=e?e.trim():"",i&&""==e?n.find(".error-message").html(phpErrorMsg[903]):(ajaxDeleteData(a,t),$(this).dialog("close"))}}),o.push({text:"Cancel",id:"Cancel",click:function(){$(this).dialog("close")}}),n.dialog("option","buttons",o),n.closest(".ui-dialog").find(".ui-dialog-buttonpane button:last").focus()}else showMsgDialog("Anda belum memilih data yang hendak dihapus.")}function duplicateData(){var e=selectedTab.newPanel[0].id,t=tabParam[e].phpDataListFile,a=($("#"+e+" .data-list"),tabParam[e].selectedPkey);0!=a.length?($("#dialog-message").html("Anda yakin akan menduplikasi data ini ?"),$("#dialog-message").dialog({width:300,modal:!0,title:"Konfirmasi Duplikasi Data",open:function(){$(this).closest(".ui-dialog").find(".ui-dialog-buttonpane button:last").focus()},close:function(){},buttons:{OK:function(){$.ajax({type:"POST",url:t,data:{action:"duplicate",selectedPkey:a}}).done(function(e){var t=parseError(e);0==t.valid&&""!=t.errorMsg&&showMsgDialog(t.errorMsg,"Duplikasi Data Gagal"),updateData(!1)}),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}})):showMsgDialog("Anda belum memilih data yang hendak diduplikasi.")}function printTransaction(e,t){var a=selectedTab.newPanel[0].id,n=tabParam[a].selectedPkey;if(0!=n.length)if(t=t||!1)for(var i=0;i<n.length;i++)window.open(e+"/"+n[i],"_blank");else window.open(e+"/"+n);else showMsgDialog("Anda belum memilih data yang hendak diprint.")}function changeStatus(e,t){var a=$("#dialog-message"),n=selectedTab.newPanel[0].id,i=tabParam[n].selectedPkey,l=tabParam[n].transactionStatus,o=1==tabParam[n].isTransaction&&e==l.length;if(0==i.length)return showMsgDialog("Anda belum memilih data yang hendak diubah statusnya."),void $("[name=selStatus-"+selectedTab.newPanel[0].id+"]").val(0);var r="Anda yakin akan mengubah status data ini menjadi "+t+" ?";1==tabParam[n].isTransaction&&o&&(r+='<div class="description"><div class="error-message"></div><textarea name="txtDesc" type="textarea" class="form-control" style="height:5em" placeholder="'+ucfirst(phpLang.cancelReason)+' ..."></textarea></div>'),a.html(r),a.dialog({width:300,height:"auto",modal:!0,close:function(){a.find(".error-message").html(""),a.val("")},title:"Konfirmasi Perubahan Status"});var d=new Array;d.push({text:"OK",id:"OK",click:function(){var t=a.find("[name=txtDesc]").val();t=t?t.trim():"",o&&""==t?a.find(".error-message").html(phpErrorMsg[903]):(changeStatusData(e,i,0,t),$(this).dialog("close"))}}),o&&d.push({text:"OK & Duplikasi",id:"OKCopy",click:function(){var t=a.find("[name=txtDesc]").val();t=t?t.trim():"",o&&""==t?a.find(".error-message").html(phpErrorMsg[903]):(changeStatusData(e,i,1,t),$(this).dialog("close"))}}),d.push({text:"Cancel",id:"Cancel",click:function(){$(this).dialog("close")}}),a.dialog("option","buttons",d),a.closest(".ui-dialog").find(".ui-dialog-buttonpane button:last").focus(),$("[name=selStatus-"+selectedTab.newPanel[0].id+"]").val(0)}function setRowToLoadingState(e,t){for(i=0;i<t.length;i++){var a=$("#"+e+" [relId="+t[i]+"]");deselectRow(a,e);var n=a.height();a.css("position","relative"),a.append('<div class="loading-overlay" style="width:100%;  background-color:rgba(0, 0, 0, .3); position: absolute; top:0; left:0; text-align:center; padding-top:5px;"><div class="loading-page-icon fas fa-spinner fa-spin"></div></div>'),a.find(".loading-overlay").css("height",n+"px"),a.attr("class","data-record unselectable")}}function changeStatusData(e,t,a,n){var i=selectedTab.newPanel[0].id,l=tabParam[i].phpDataListFile;t=tabParam[i].selectedPkey;$.ajax({type:"POST",url:l,data:{action:"changestatus",newStatus:e,selectedPkey:t,copyData:a,description:n}}).done(function(e){var t=parseError(e);0==t.valid&&""!=t.errorMsg&&showMsgDialog(t.errorMsg,"Perubahan Status Gagal"),updateData(!1)})}function changeTag(e,t){var a=selectedTab.newPanel[0].id,n=($("#"+a),tabParam[a].phpDataListFile),i=tabParam[a].selectedPkey;if(0!=i.length){var l="Anda yakin akan mengubah tag data ini menjadi "+t+" ?";0==e&&(l="Anda yakin akan menghilangkan tag data ini ?"),$("#dialog-message").html(l),$("#dialog-message").dialog({width:300,modal:!0,title:"Konfirmasi Update Tag",open:function(){$(this).closest(".ui-dialog").find(".ui-dialog-buttonpane button:last").focus()},buttons:{OK:function(){setRowToLoadingState(a,i),$.ajax({type:"POST",url:n,data:{action:"changetag",newTag:e,selectedPkey:i}}).done(function(e){generateDataRow(a,i)}),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}})}else showMsgDialog("Anda belum memilih data yang hendak diubah tag nya.")}function bindDataRowChkBox(e){e.prop("checked")?selectMultiRows(e.closest(".data-record")):deselectRow(e.closest(".data-record"))}function generateDataRow(e,t){var a=tabParam[e].phpDataListFile;$.ajax({type:"POST",url:a,data:{action:"generaterow",selectedPkey:t}}).done(function(t){if(t){t=JSON.parse(t);for(i=0;i<t.length;i++){var a=t[i].pkey,n=t[i].html,l=$("#"+e+" [relId="+a+"]");l.fadeOut("slow").replaceWith(n),(l=$("#"+e+" [relId="+a+"]")).fadeIn("slow")}bindEl($("#"+e+" .data-record [name='chkRow[]']"),"click",function(){bindDataRowChkBox($(this))})}})}function parseError(e){var t=JSON.parse(e),a="",n=!0;for(i=0;i<t.length;i++)n=t[i].valid,a=a+"<li>"+t[i].message+"</li>";""!=a&&(a='<ul class="message-dialog-ul">'+a+"</ul>");var l={};return l.valid=n,l.errorMsg=a,l}function showMsgDialog(e,t){void 0==t&&(t="Informasi"),$("#dialog-message").html(e),$("#dialog-message").dialog({width:600,modal:!0,title:t,buttons:{OK:function(){$(this).dialog("close")}}})}function rebuildPaging(e,t,a){if(e.html(""),0==t){var n=$('<option value="0">0 / 0</option>');e.append(n)}else for(i=0;i<t;i++){var l="";a==i&&(l='selected="selected"');n=$('<option value="'+i+'" '+l+">"+(i+1)+" / "+t+"</option>");e.append(n)}}function updateRowsInformation(e){var t=".transaction-detail";e.find(t).not(".row-template "+t).each(function(){var e=$(this).find(">.transaction-detail-row").length,a=$(this).attr("attr-level")||0,n=$(this).attr("attr-group")?$(this).attr("attr-group")+"TotalRows":"hidTotalRows",i=$(this).find("[name='"+n+"["+a+"][]']").first();0==i.length&&(i=$('<input name="'+n+"["+a+'][]" type="hidden">'),$(this).closest(t).prepend(i)),i.val(e)})}function submitForm(e,t,a,n){var i=t.tabID,l=a.parentPanelId,o=a.parentTitle,r=a.autoPrintURL;e.preventDefault();var d=$(e.target),s=d.find("[name=hidSaveAndNew]").val();disabledButton(d.find(".btn-primary")),updateRowsInformation(d);d.data("bootstrapValidator");$.ajax({type:"POST",url:d.attr("action"),beforeSend:function(){ckeditorUpdateElement(selectedTab.newPanel[0].id)},data:d.serialize(),success:function(e){onFormSubmitDone({form:d,saveAndNew:s,tabID:i,autoPrintURL:r},e,{parentPanelId:l,parentTitle:o},n)},dataType:"json"})}function ckeditorUpdateElement(e){var t=ckeditorList[e];if(void 0!=t)for(i=0;i<t.length;i++){var a=t[i].elementId,n=t[i].editor;$("#"+a).val(n.getData())}}function disabledButton(e,t){void 0==t&&(t=!0),e.each(function(e){$(this).prop("disabled",t),1==t?$(this).find(".loading-icon").show():$(this).find(".loading-icon").hide()})}function onFormSubmitDone(formArgs,result,parentElement,responseTarget){var form=formArgs.form,saveAndNew=formArgs.saveAndNew,tabID=formArgs.tabID,autoPrintURL=formArgs.autoPrintURL,parentPanelId=parentElement.parentPanelId,parentTitle=parentElement.parentTitle,responseTargetValueObj=eval(responseTarget.value),responseTargetKeyObj=eval(responseTarget.key),revalidateField=eval(responseTarget.revalidateField);void 0==saveAndNew&&(saveAndNew=0);var error="";for(i=0;i<result.length;i++)error=error+"<li>"+result[i].message+"</li>";if(""!=error&&(error='<ul class="message-dialog-ul">'+error+"</ul>"),$("#"+tabID+" .notification-msg").html(error).hide().fadeToggle("fast"),result[0].valid)if(parentPanelId)if(1==saveAndNew){$("#"+tabID+" .notification-msg").hide();var href=tabParam[tabID].href.replace(/&id=([^&]$|[^&]*)/i,"");$("#"+tabID).load(href)}else{$("#"+tabID+" .notification-msg").removeClass("bg-red-cardinal").addClass("bg-green-avocado");var nextPageButton=$("#"+tabID+" .next-page"),nextPkey=nextPageButton.attr("attr-pkey")||0;if(0==(nextPkey=parseInt(nextPkey))){selectedTab.newTab[0].remove();var num_tabs=findTabIndexByTitle(parentTitle);$tabs.tabs("option","active",num_tabs),$tabs.tabs("refresh"),updateData(!1,parentPanelId)}else nextPageButton.click();var saveAndProcess=!1;$("#"+tabID+" [name=hidSaveAndProceed]")&&1==$("#"+tabID+" [name=hidSaveAndProceed]").val()&&(saveAndProcess=!0),autoPrintURL&&saveAndProcess&&2==result[0].data.statuskey&&$("#"+tabID+" [name=hidId]")&&window.open(autoPrintURL+"/"+result[0].data.pkey)}else{var fieldValue="name",fieldKey="pkey";responseTarget.valueDBField&&""!=responseTarget.valueDBField&&(fieldValue=responseTarget.valueDBField),responseTargetValueObj.val(result[0].data[fieldValue]),responseTargetKeyObj.val(result[0].data[fieldKey]).change(),revalidateField&&responseTargetValueObj.closest("form").bootstrapValidator("revalidateField",responseTargetValueObj.attr("name")),hideOverlayScreen()}else $("#"+tabID+" .notification-msg").removeClass("bg-green-avocado").addClass("bg-red-cardinal"),form.data("bootstrapValidator").resetForm(),$("html, body").animate({scrollTop:0},"slow");disabledButton(form.find(".btn-primary"),!1)}function deleteImageUploaderThumb(e,t,a){$(e).closest("li").remove(),updateItemImageArray(t,a)}function deleteFileUploaderThumb(e,t,a){$(e).closest("li").remove(),updateItemFileArray(t,a)}function pushImageThumb(e,t,a,n,i){var l=selectedTab.newPanel[0].id;void 0!=e.tabID&&(l=e.tabID);var o=phpConfiguration.uploadTempDocShort,r=$("#defaultForm-"+l+" ."+e.name);0==a&&r.find(".image-list").html("");var d=t.fileName.substr(t.fileName.lastIndexOf(".")+1);fileurl="../phpthumb/phpThumb.php?src="+o+t.folder+t.token+"/"+t.fileName+"&w=150&h=150&far=C&hash="+t.phpThumbHash,"ico"==d&&(fileurl=phpConfiguration.uploadTempURL+t.folder+t.token+"/"+t.fileName);var s='<li relfilename="'+t.fileName+'" relPHPThumbHash="'+t.phpThumbHash+'">';s+='<div class="file-uploader-image"><img src="'+fileurl+'"/></div>',s+='<div class="file-uploader-action-bar">',s+="<a href=\"#\" onClick=\"deleteImageUploaderThumb(this,{'tabID':'"+e.tabID+"' , 'name':'"+e.name+"'},'"+t.token+'\')"><i class="far fa-times" style="float:right; font-size:1.2em;" ></i></a>',s+='<a href="/phpthumb/phpThumb.php?src='+o+t.folder+t.token+"/"+t.fileName+"&far=C&hash="+t.phpThumbHash+'" target="_blank"><i class="far fa-eye" style="float:right; font-size:1.2em; margin-right:0.5em; padding-bottom:0.2em"></i></a>',s+="",s+="</div>",s+="</li>",r.find(".image-list").append(s),updateItemImageArray(e,t.token),r.find(".image-list li:last img").on("load",function(){$(this).closest(".file-uploader-image").css("background-image","none")})}function updateItemImageArray(e,t){var a=selectedTab.newPanel[0].id;void 0!=e.tabID&&(a=e.tabID);var n=$("#defaultForm-"+a+" ."+e.name);uploadedImage[t+a]=Array(),$("#defaultForm-"+a+" ."+e.name+" .image-list li").each(function(e){uploadedImage[t+a].push($(this).attr("relfilename"))}),n.find("[name="+e.name+"]").val(uploadedImage[t+a])}function createImageUploader(e,t,a,n,i){var l=selectedTab.newPanel[0].id;void 0!=e.tabID&&(l=e.tabID);var o=$("#defaultForm-"+l).find("."+e.name);if(void 0!=t.token&&""!=t.token||(t.token=Math.floor(1e3*Math.random()+1).toString()+$.now()),uploadedImage[t.token+l]=Array(),o.append('<input type="hidden" name="'+e.name+'" />'),o.append('<input type="hidden" name="token-'+e.name+'" value="'+t.token+'" />'),void 0!=i&&""!=i&&o.append('<input type="hidden" name="'+i+'" />'),void 0!=t.arrImage||""==t.arrImage){var r;for(r=0;r<t.arrImage.length;r++)pushImageThumb(e,{folder:t.folder,token:t.token,fileName:t.arrImage[r],phpThumbHash:t.phpThumbHash[r]},a,n,i)}new qq.FileUploader({element:o.find(".file-uploader")[0],action:"fileuploader.php?action=upload&folder="+t.folder+"&token="+t.token,allowedExtensions:["jpg","jpeg","png","gif","ico"],onComplete:function(l,o,r){1==r.success&&pushImageThumb(e,{folder:t.folder,token:t.token,fileName:r.fileName,phpThumbHash:r.phpThumbHash},a,n,i)}});return t.token}function createFileUploader(e,t,a,n,i){var l=selectedTab.newPanel[0].id,o=$("#defaultForm-"+l+" ."+e);if(void 0!=a&&""!=a||(a=Math.floor(1e3*Math.random()+1).toString()+$.now()),uploadedFile[a+l]=Array(),o.append('<input type="hidden" name="'+e+'" />'),o.append('<input type="hidden" name="token-'+e+'" value="'+a+'" />'),void 0!=n||""==n){var r;for(r=0;r<n.length;r++)pushFileThumb(e,t,a,n[r],i)}new qq.FileUploader({element:o.find(".file-uploader")[0],action:"fileuploader.php?action=upload&folder="+t+"&token="+a,onComplete:function(n,l,o){1==o.success&&pushFileThumb(e,t,a,o.fileName,i)}});return a}function pushFileThumb(e,t,a,n,i){var l=$("#defaultForm-"+selectedTab.newPanel[0].id+" ."+e),o=(n.substr(n.lastIndexOf(".")+1).toLowerCase(),'<li relfilename="'+n+'" >');o+='<div class="panel">',o+='<div class="file-uploader-description"><a href="/download.php?filename='+t+a+"/"+n+'" target="_blank" title="'+n+'">'+n+"</a></div>",o+='<div class="delete-icon" onClick="deleteFileUploaderThumb(this,\''+e+"','"+a+'\')"><i class="fas fa-times"></i></div>',o+='<div style="clear:both;"></div>',o+="</div>",o+="</li>",0==i&&l.find(".file-list").html(""),l.find(".file-list").append(o),updateItemFileArray(e,a),l.find(".file-list li:last img").on("load",function(){$(this).closest(".file-uploader-image").css("background-image","none")})}function updateItemFileArray(e,t){var a=selectedTab.newPanel[0].id,n=$("#defaultForm-"+a+" ."+e);uploadedFile[t+a]=Array(),$("#defaultForm-"+selectedTab.newPanel[0].id+" ."+e+" .file-list li").each(function(e){uploadedFile[t+a].push($(this).attr("relfilename"))}),n.find("[name="+e+"]").val(uploadedFile[t+a])}function loadImageVariant(e,t,a,n){var i=$("#defaultForm-"+selectedTab.newPanel[0].id+" ."+e);title="Update Variasi Warna";var l=i.find("[name="+n+"]").val(),o="#000000";if(""!=l){var r=JSON.parse(l);void 0!=r[a.fileName]&&(o=r[a.fileName][0].fileColor)}content='<div class="'+n+'" reltoken ="'+a.fileName+'">',content+='<ul class="image-list">',content+='<li relfilename="'+a.fileName+'"  >',content+='<div class="file-uploader-image" ><img src="../phpthumb/phpThumb.php?src='+phpConfiguration.uploadTempDoc+a.folder+a.token+"/"+a.fileName+"&w=150&h=150&far=C&hash="+a.phpThumbHash+'"/></div>',content+='<div class="file-uploader-action-bar">',content+='<input type="color" class="form-control" style="padding:0 !important; width:2em; height:1.5em; border-radius:0; margin:auto;" name="variantColor[]" value="'+o+'" />',content+="</div>",content+="</li>",content+="</ul>",content+='<div style="clear:both; height:1em;"></div>',content+='<div class="file-uploader">',content+="<noscript>",content+="<p>Please enable JavaScript to use file uploader.</p>",content+="</noscript>",content+="</div>",content+="</div>",alert("deprecated overlay screen"),$("."+n+" .image-list").sortable({placeholder:"sortable-placeholder"}),$("."+n+" .image-list").disableSelection(),createImageUploaderforImageVariant(e,n,{folder:"item-variant/"}),$("."+n+" .qq-upload-button").after('<div style="float:left; margin-left:1.5em;"  class="btn btn-danger" onClick="hideOverlayScreen()">Batal</div> <div style="float:left; margin-left:0.5em;" class="btn btn-primary" onClick="updateItemImageArrayforImageVariant(\''+e+"','"+n+"','"+a.token+"')\">Simpan</div>")}function createImageUploaderforImageVariant(e,t,a){var n=$("."+t),l=(e=$("#defaultForm-"+selectedTab.newPanel[0].id+" ."+e),n.attr("reltoken"));token=l;var o=e.find("[name="+t+"]").val();if(""!=o){var r=JSON.parse(o);if(void 0!=r[l])for(i=1;i<r[l].length;i++)pushImageThumbforImageVariant(t,{folder:a.folder,token:token,fileName:r[l][i].fileName,phpThumbHash:r[l][i].phpThumbHash},r[l][i].fileColor)}new qq.FileUploader({element:n.find(".file-uploader")[0],action:"fileuploader.php?action=upload&folder="+a.folder+"&token="+token,allowedExtensions:["jpg","jpeg","png","gif"],onComplete:function(e,n,i){1==i.success&&pushImageThumbforImageVariant(t,{folder:a.folder,token:token,fileName:i.fileName,phpThumbHash:i.phpThumbHash})}})}function pushImageThumbforImageVariant(e,t,a){var n=$("."+e);void 0!=a&&""!=a||(a="#000000");var i='<li relfilename="'+t.fileName+'" relPHPThumbHash ="'+t.phpThumbHash+'">';i+='<div class="file-uploader-image" ><img src="../phpthumb/phpThumb.php?src='+phpConfiguration.uploadTempDoc+t.folder+t.token+"/"+t.fileName+"&w=150&h=150&far=C&hash="+t.phpThumbHash+'"/></div>',i+='<div class="file-uploader-action-bar" style="width:40%; margin:auto;">',i+='<div style="width:50%;float:left;"><input type="color" class="form-control" style="padding:0 !important; width:2em; height:1.5em; border-radius:0;" name="variantColor[]" value="'+a+'" /></div>',i+='<div style="width:50%;float:left; margin-top:0.2em;"><div class="delete-icon-small minerva-icon-15" onClick="deleteImageUploaderThumbforImageVariant(this,\''+e+"','"+t.token+"')\"></div></div>",i+="</div>",i+="</li>",n.find(".image-list").append(i),n.find(".image-list li:last img").on("load",function(){$(this).closest(".file-uploader-image").css("background-image","none")})}function deleteImageUploaderThumbforImageVariant(e,t,a){$(e).closest("li").remove()}function updateItemImageArrayforImageVariant(e,t,a){var n=$("."+t),i=(e=$("#defaultForm-"+selectedTab.newPanel[0].id+" ."+e),n.attr("reltoken")),l=e.find("[name="+t+"]").val(),o={};""!=l&&(o=JSON.parse(l)),o[i]=new Array;var r;$("."+t+" .image-list li").each(function(e){(r=new Object).fileName=$(this).attr("relfilename"),r.fileColor=$(this).find('[name="variantColor[]"]').val(),r.phpThumbHash=$(this).attr("relPHPThumbHash"),o[i].push(r)}),e.find("[name="+t+"]").val(JSON.stringify(o)),hideOverlayScreen()}function onChangeCurrency(e,t){var a=selectedTab.newPanel[0].id;e=$(e),t||(t="input-currency-rate");var n=e.closest(".mnv-currency").find("."+t),i=$("#"+a+" .mnv-input-number");1==e.val()?(n.prop("readonly",!0),n.val(1),changeNumberDecimal(n,!0),changeNumberDecimal(i,!0)):(n.prop("readonly",!1),changeNumberDecimal(n,!1),changeNumberDecimal(i,!1)),$("#"+a+" .mnv-input-number").blur(),$("#"+a+" .mnv-active-currency").html(e.find("option:selected").text()),n.change().blur()}function updateAvailableCurency(){}function arrayColumn(e,t){return e.map(function(e,a){return e[t]})}function mnvOptionsRowShow(e){var t=e.find(".options-row .form-panel"),a=e.find(".options-row .form-panel-result");t.find("input,select,textarea").each(function(){label=$(this).attr("attr-label"),label&&(type=$(this).attr("type"),"select"==type?value=$(this).find("option:selected").text():value=$(this).val(),el=e.find("."+label),elVal=el.find("."+label+"-value").first(),el.hide(),elVal.html(""),value&&(elVal.html(value),el.show()))}),a.show()}function mnvOptionsRowOnClick(e){$newRow=e.closest(".transaction-detail-row");var t=$newRow.find(".options-row .form-panel-result"),a=$newRow.find(".options-row .form-panel");t.hide();a.toggle().is(":visible")||mnvOptionsRowShow($newRow)}function updateTemplateRow(e,t){var a=selectedTab.newPanel[0].id,n=JSON.parse(t);$("#"+a+' [name="'+n[0].selector+'[]"]').each(function(){""==$(this).val()&&removeDetailRows($(this),!0)}),addNewTemplateRow(e,t)}function addNewTemplateRow(e,t,a,n,i){var l=selectedTab.newPanel[0].id,o=$("#defaultForm-"+l).find("[name='detailRowsToken[]']:enabled"),r=".transaction-detail",d="transaction-detail-row",s=a?a.find("."+e):$("#defaultForm-"+l+" ."+e),c=s.clone().removeClass(e).removeClass("row-template").addClass(d);if(i?c.insertAfter(i):c.insertBefore(s.first()),c.show(),void 0!=t&&t.length>0){var u,p=JSON.parse(t);for(u=0;u<p.length;u++)"string"===jQuery.type(p[u].value)&&(p[u].value=decodeHTMLEntities(p[u].value)),c.find('[name="'+p[u].selector+'[]"]').val(p[u].value)}c.find(".inputnumber").bind("blur",function(e){inputNumberOnBlur($(this))}),c.find(".inputdecimal").bind("blur",function(e){inputNumberOnBlur($(this),2)}),c.find(".inputautodecimal").bind("blur",function(e){inputNumberOnBlur($(this),-2)}),c.find(".inputnumber, .inputdecimal, .inputautodecimal").bind("focus",function(e){inputNumberOnFocus($(this))}),c.find("input, select, textarea").removeAttr("disabled tabIndex"),c.find(".no-tabs-index, input[readonly], select[readonly], textarea[readonly]").attr("tabIndex","-1"),c.find(".multi-selectbox").searchableOptionList({maxHeight:"250px",showSelectAll:!0,showSelectionBelowList:!0}),c.find(".input-date").removeClass("hasDatepicker"),c.find(".input-date").removeAttr("id"),c.find(".input-date").datepicker({currentText:"Now",dateFormat:"dd / mm / yy",changeMonth:!0,changeYear:!0}),c.find(".row-template").find("input, select, textarea").attr("disabled",!0).attr("tabIndex","-1"),c.find(".ckeditor").each(function(){var e=(new Date).getTime()+Math.floor(99999*Math.random()+1);$(this).attr("id",e),$("#"+e).ckeditor()}),c.find(".btn-more-options").bind("click",function(e){mnvOptionsRowOnClick($(this))}),c.find(".mnv-barcode-input").keydown(function(e){barcodeHandler(this,e)});p=o.last().val();token=p?parseInt(p)+1:1,c.find("[name='detailRowsToken[]']").val(token);var h=c.find(".options-row .form-panel").find("input, select, textarea");return h.addClass("label-style"),h.bind("focusout",function(e){$(this).addClass("label-style")}).bind("focus",function(e){$(this).removeClass("label-style")}),c.find(".remove-button").bind("click",function(e){removeDetailRows(this),getTabObj()&&$.isFunction(getTabObj().afterRemoveRowHandler)&&getTabObj().afterRemoveRowHandler()}),c.find(".add-row-button").unbind("click").bind("click",function(e){$row=addNewTemplateRow($(this).attr("attr-template"),null,$(this).closest(r),n,$(this).closest("."+d)),$.isFunction(getTabObj().afterAddNewTemplateRowHandler)&&getTabObj().afterAddNewTemplateRowHandler($row)}),updateRowNumber(c.closest(r)),n&&n(),c}function inputNumberOnFocus(e){e.prop("readonly")||e.prop("disabled")||0!=e.val()&&$.isNumeric(unformatCurrency(e.val()))||e.val("")}function inputNumberOnBlur(e,t){""!=e.val()&&$.isNumeric(unformatCurrency(e.val()))||e.val(0);var a=selectedTab.newPanel[0].id,n=parseInt(e.attr("mnv-attr-decimal"))||0;if(0!=n&&(t=n),void 0==t){t=0;try{var i=tabParam[a].obj.tablekey;t=void 0==phpModuleSetting[i]?0:phpModuleSetting[i].decimalnumber}catch(e){}}else-2==t&&(t=e.val()%1!=0?2:0);e.formatCurrency({roundToDecimalPlace:t})}function loadOverlayScreen(e){if($(":focus").blur(),$("html, body").css("overflow","hidden"),$("#popup-panel").fadeIn("fast"),e.content&&$("#popup-panel .content-panel").html(e.content),e.url){var t=Date.now(),a="";e.element.valueDBField&&(a="&valueDBField="+e.element.valueDBField);var n=e.url+"?quickadd=1&targetID="+e.targetID+"&keyElement="+e.element.key+"&valueElement="+e.element.value+a+"&revalidateField="+e.revalidateField+"&tabID="+t;$("#popup-panel .content-panel").html('<div id="'+t+'" class="form-panel"><div class="header-panel div-table"><div class="div-table-row"><div class="title-panel div-table-col"></div><div class="close-panel div-table-col"><i class="fas fa-times"></i></div></div></div><div class="detail-panel"></div></div>'),$("#popup-panel .content-panel .title-panel").html(e.title),$("#popup-panel .content-panel .detail-panel").load(n),e.width&&$("#popup-panel .form-panel").css("width",e.width),$("#"+t+" .close-panel").click(function(){hideOverlayScreen()})}}function decreaseActiveAjaxConnections(e){e.activeAjaxConnections--,0==e.activeAjaxConnections&&hideOverlayScreen()}function hideOverlayScreen(){$("html, body").css("overflow","inherit"),$("#popup-panel").fadeOut("fast")}function disableFormSaveOnEnter(e){e.bind("keyup keypress",function(e){if(13==(e.keyCode||e.which)&&!$(e.target).is("textarea"))return e.preventDefault(),!1})}function htmlEntities(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function decodeHTMLEntities(e){if(e){if("string"!=typeof e)return e;for(var t=[["amp","&"],["apos","'"],["#x27","'"],["#x2F","/"],["#39","'"],["#47","/"],["lt","<"],["gt",">"],["nbsp"," "],["quot",'"']],a=0,n=t.length;a<n;++a)e=e.replace(new RegExp("&"+t[a][0]+";","g"),t[a][1]);return e}}function openTab(e,t){addTab(e,t,!0,!0)}function removeDetailRows(obj,alwaysDeleteRow){var transactionTable=$(obj).closest(".transaction-detail");$listRow=transactionTable.find(">.transaction-detail-row");var detailRow=$(obj).closest(".transaction-detail-row");$listRow.length<=1&&!alwaysDeleteRow?(detailRow.find("input").not(obj).val("").blur(),detailRow.find("textarea").html(""),detailRow.find("select").prop("selectedIndex",0)):detailRow.remove(),transactionTable.find("input:checkbox").each(function(){updateChkBoxOnClick(this)}),updateRowNumber(transactionTable);var handler=$(obj).attr("attrhandler");void 0!=handler&&eval(handler)}function clearAllRows(e,t){t=void 0==t||t,e.find(".transaction-detail-row").find(".remove-button").each(function(){removeDetailRows(this,t)})}function convertDateToStandartFormat(e){var t=e.split(" / ");return t[2]+"-"+t[1]+"-"+t[0]}function getTabObj(e){var t=e||selectedTab.newPanel[0].id;return tabParam[t].obj}function setReadonly(e,t){e.prop("readonly",t),t?e.attr("tabindex","-1"):e.removeAttr("tabindex")}function updateAvailableUnit(e,t){$.ajax({type:"GET",url:"ajax-item",data:{action:"getAvailableUnit",itemkey:e.val()},success:function(e){e=JSON.parse(e);var a={};for(i=0;i<e.length;i++)a[e[i].conversionunitkey]=e[i].unitname;var n=t.prop?t.prop("options"):t.attr("options");$("option",t).remove(),$.each(a,function(e,t){n[n.length]=new Option(t,e)}),t.find("option").each(function(t){$(this).attr("relconversionmultiplier",e[t].conversionmultiplier)}),t.val(e[0].deftransunitkey)}})}function updateComboboxReadonly(e,t){var a=void 0==t||t;e.find("option:selected").attr("disabled",!1),e.find("option:not(:selected)").attr("disabled",a)}function quickAddCallback(){}function columnConform(e){var t=0,a=-1,n=0,i=new Array;for($(e).each(function(){$(this).height("auto")}),$(e).each(function(e){if(t=$(this).offset().top,-1==a&&(a=t,n=$(this).height()),a!=t){for(currentDiv=0;currentDiv<i.length;currentDiv++)i[currentDiv].height(n);n=$(this).height(),i.length=0,t=$(this).offset().top,a=t}n<$(this).height()&&(n=$(this).height()),i.push($(this))}),currentDiv=0;currentDiv<i.length;currentDiv++)i[currentDiv].height(n)}function changeNumberDecimal(e,t){t?(e.removeClass("inputdecimal").addClass("inputnumber"),e.unbind("blur").bind("blur",function(e){inputNumberOnBlur($(this))})):(e.removeClass("inputnumber").addClass("inputdecimal"),e.unbind("blur").bind("blur",function(e){inputNumberOnBlur($(this),2)})),e.blur()}function updateDecimal(e,t){var a=$(e).parent().parent();t=t||"discountValueInUnit[]";var n=a.find("[name='"+t+"']"),i=$(e).val();n.removeClass("inputnumber").addClass("inputdecimal"),1==i?n.unbind("blur").bind("blur",function(e){inputNumberOnBlur($(this))}):n.unbind("blur").bind("blur",function(e){inputNumberOnBlur($(this),2)}),n.blur()}function updateFinalDiscountDecimal(e,t){if(!t){t=$(e).parent().parent().find("[name='finalDiscount']")}var a=$(e).val();t.removeClass("inputnumber").addClass("inputdecimal"),1==a?t.unbind("blur").bind("blur",function(e){inputNumberOnBlur($(this))}):t.unbind("blur").bind("blur",function(e){inputNumberOnBlur($(this),2)}),t.blur()}function updateRowNumber(e){var t=1;e.find(".row-number").each(function(){$(this).html(t+"."),t++})}function barcodeHandler(e,t){13==(t.which?t.which:t.keyCode)&&($(e).attr("isbarcode",1),t.preventDefault())}function updateChkBoxOnClick(e,t){var a=$(e).prop("checked")?1:0;$(e).val(a),$(e).next().val(a),t&&t(),$(e).next().change()}function updateChkBoxOnChange(e){var t="",a=0;1==$(e).val()&&(t="checked",a=1),$(e).prev().prop("checked",t).change(),$(e).prev().val(a)}function updateChkPick(e,t){var a=(e=$(e)).closest(".mnv-checkbox-group");if(!e.attr("relignore")){var n=a.find("[name='chkPick[]']:enabled");n.prev().attr("relignore",!0),n.val(e.next().val()).change(),n.prev().removeAttr("relignore"),t&&t()}}function updateChkMaster(e,t){var a=(e=$(e)).next().attr("name"),n=e.next().attr("name").replace("[]","")+"-master";if(!e.attr("relignore")){var i=e.closest(".mnv-checkbox-group"),l=i.find("[name='"+n+"']");if(l.prev().attr("relignore",!0),0==e.val())l.val(0).change();else{var o=!0;i.find("[name='"+a+"']:enabled").each(function(){if(0==$(this).val())return o=!1,void i.find("[name='"+n+"']").val(0).change()}),o&&i.find("[name='"+n+"']").val(1).change()}l.prev().removeAttr("relignore"),t&&t()}}function waFormat(e){return e=e.replace(" ",""),"0"==(e=e.replace("-","")).substring(0,1)&&(e=e.substring(1,e.length)),"+62"==e.substring(0,3)&&(e=e.substring(3,e.length)),"+"==e.substring(0,1)&&(e=e.substring(1,e.length)),e="62"+e}function ucfirst(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}function sortColumn(e,t){var a=$("#"+t),n=e.attr("reltype");tabParam[t].orderby=e.attr("relcol"),tabParam[t].ordertype=n,a.find(".sortable").removeClass("sortable-active"),a.find(".sortable .order-type").removeClass("arrow-up").removeClass("arrow-down").hide(),e.addClass("sortable-active"),1==n?e.find(".order-type:first").addClass("arrow-down").show():e.find(".order-type:first").addClass("arrow-up").show(),e.attr("reltype",-1*n),updateData(!1)}function clearText(e,t){var a=e.closest("div"),n=$("[name=quick-search-"+t+"]");""!=n.val().trim()&&(n.val(""),a.find(".clear-text-icon").hide(),a.find(".search-icon").show(),$("[name=selPage-"+t+"] option:first").attr("selected","selected"),updateData(!1))}function quickSearch(e,t){var a=e.val(),n=e.closest("div");a?(n.find(".search-icon").hide(),n.find(".clear-text-icon").show(),e.attr("reltype",1)):(n.find(".clear-text-icon").hide(),n.find(".search-icon").show())}function quickSearchOnLostFocus(e,t){if(0!=e.attr("reltype")){e.attr("reltype",0);""==e.val()&&($("[name=selPage-"+t+"] option:first").attr("selected","selected"),updateData(!1))}}function updateDataListSettings(e){var t=selectedTab.newPanel[0].id,a=$("#"+t),n=[],i=tabParam[t].phpDataListFile;e.find(".data-list-settings .column-preview .column").each(function(){var e={};e.code=$(this).attr("relcol"),e.width=$(this).css("width"),n.push(e)}),$.ajax({url:i,method:"POST",data:"action=updatecolumnheader&fileName="+tabParam[t].phpDataListFile+"&param="+JSON.stringify(n),success:function(e){a.find(".data-list").remove();var t=a.find(".data-list-settings");t.addClass("border-green text-green-avocado"),t.css("text-align","center");var n='<i class="fas fa-check"></i> '+phpLang.settingsSaved+phpLang.pleaseReopenThisTab;t.html(n)}})}function refreshDataList(e,t,a){if(phpDataListFile=tabParam[t].phpDataListFile,targetContent=e.find(".data-list"),targetContent.html(_LOADING_ICON_),"salesOrderList"==phpDataListFile){var n=1==a?"/cron/updateMarketplaceOrders.php":"/cron/updateMarketplaceOnRrefresh.php";$.ajax({type:"POST",url:n,asyn:!1})}updateData(!1)}function updatePreview(e){var t="",a=e.closest(".data-list-settings"),n=e.closest(".div-table-row"),i=n.find("[name='chkTitle[]']").val(),l=n.find("[name='title[]']").val(),o=n.find("[name='hidCode[]']").val(),r=n.find("[name='width[]']").val(),d=a.find(".column-preview"),s=[];a.find("[name='chkTitle[]']").each(function(){if(1==$(this).val()){var e=$(this).closest(".div-table-row").find("[name='hidCode[]']").val();s.push(e)}}),d.find(".column").each(function(){var e=$(this).attr("relcol");-1==jQuery.inArray(e,s)&&$(this).remove()});var c=!1;d.find(".column").each(function(){if($(this).attr("relcol")==o)return $(this).css("width",r+"px"),void(c=!0)}),1!=i||c||(t='<div class="div-table-col-5 column" style="width: '+r+'px" relcol="'+o+'">'+l+"</div>",d.append(t));var u=0,p="";d.find(".column").each(function(){var e=parseInt($(this).width());e>u&&(u=e,p=$(this))}),p.css("width","auto")}function multiLang(e){bindEl(e.find("[name=mnvSelLang]"),"change",function(){0==$(this).val()?(e.find("div[rellang]").show(),e.find("div[rellang]:not(:first-child)").addClass("margin-top-05")):(e.find("div[rellang]").removeClass("margin-top-05").hide(),e.find("div[rellang="+$(this).val()+"]").show())})}function isMobile(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function reInsertSelectBox(e,t,a){var n={};if(void 0!=a&&a.key)for(i=0;i<t.length;i++){var l={};void 0!=a.rel&&$.each(a.rel,function(e,a){l[e]=t[i][a]}),n[t[i][a.key]]={label:t[i][a.label],rel:l}}else $.each(t,function(e,t){n[e]=t});var o;e.each(function(){o=$(this),updateSelectBox($(this),n)}),e.first().find("option:eq(0)").prop("selected",!0).change()}function updateSelectBox(e,t){var a=e.prop?e.prop("options"):e.attr("options");$("option",e).remove(),$.each(t,function(t,n){a[a.length]=new Option(n.label,t),void 0!=n.rel&&$.each(n.rel,function(t,n){e.find("option:eq("+(a.length-1)+")").attr(t,n)})})}var _LOADING_ICON_='<div style="width:100%; text-align:center; margin:1em 0;"><span class="loading-icon fas fa-spinner fa-spin"></span></div>',_LOADING_ICON_SMALL_='<div style="width:100%; text-align:center; margin:1em 0; font-size: 0.8em"><span class="loading-icon fas fa-spinner fa-spin"></span></div>',_DATE_FORMAT_="DD / MM / YYYY",_CONTROL_LABEL_HEIGHT_=20,_LOADING_TEMPLATE_='<div style="text-align:center"><div class="loading-page-icon fas fa-spinner fa-spin"></div></div>',selectedTab,$tabs,tabParam={},uploadedImage={},uploadedFile={},objAndValueForDetailAutoComplete={},ckeditorList={},autoSaveIntervalId={},dashboardRedrawFunc=Array();jQuery(document).ready(function(){var e="",t=!0;setInterval(function(a){e!=navigator.onLine&&((e=navigator.onLine)?t||mnvPushPopUpNotification(phpLang.internetConencted,"bg-green-avocado"):mnvPushPopUpNotification(phpLang.internetFailToConnect,"bg-red-cardinal")),t=!1},1e4),$("#mnv-popup-notification .close-all").click(function(){$("#mnv-popup-notification").find(".close-icon").click(),$(this).hide()}),$(window).resize(function(){adjustActionBarWidth(),adjustActionBarPosition(),updateControlLabelPadding()}),$(window).scroll(function(e){var t=$(window).scrollTop(),a=$(".action-bar-fixed");t>75&&!a.hasClass("fixed")?(a.addClass("fixed"),adjustActionBarWidth()):t<=75&&a.hasClass("fixed")&&(a.removeClass("fixed"),adjustActionBarWidth()),adjustActionBarPosition(),updateStickyStyle()}),addEventListener("beforeunload",function(e){e.returnValue="Apakah Anda yakin akan meninggalkan halaman ini ?"}),$("#main-menu .root").click(function(){$(this).hasClass("root-active")||($("#main-menu .submenu-panel-"+$("#main-menu .root-active").attr("rel")).hide(400,"linear"),$("#main-menu .root-active").removeClass("root-active"),$(this).addClass("root-active"),$("#main-menu .submenu-panel-"+$(this).attr("rel")).show(400,"linear"))}),$(".show-left-menu-icon").click(function(){var e=$(".left-menu-col");e.is(":visible")?e.css("display","none"):e.css("display","table-cell"),adjustActionBarWidth()}),$(".menu-child").click(function(){var e=$(this).attr("reladdr"),t=$(this).attr("reltarget");if("_blank"==t){window.open(e,t).focus()}else addTab($(this).text(),e,!0,!0)}),$(".menu-parent").click(function(){collapseAllMenu(),$(this).removeClass("inactive").addClass("active"),$(this).next("ul").show(500)}),$(".menu-setting").click(function(){addTab($(this).text(),$(this).attr("reladdr"),!0,!0)}),collapseAllMenu(),$tabs=$("#tabs").tabs({activate:function(e,t){selectedTab=t,adjustActionBarWidth(),updateStatusPanel(),0==getSelectedTabIndex()&&$.each(dashboardRedrawFunc,function(e,t){t()}),updateStickyStyle()},load:function(e,t){adjustActionBarWidth()},beforeLoad:function(e,t){t.tab.data("loaded")?e.preventDefault():(t.panel.html(_LOADING_ICON_).fadeIn(),t.jqXHR.done(function(){t.panel.fadeIn(),t.tab.data("loaded",!0)}))}});$("#tabs-menu").tabs({activate:function(e,t){var a=t.newPanel.hide().attr("id"),n=t.oldPanel.attr("id");$("#"+n).fadeOut(500),$("#"+a).fadeIn(500)}});addTab("Dashboard","summaryDashboard",!1),$tabs.delegate("span.ui-icon-close","click",function(){var e=$(this).closest("li").remove().attr("aria-controls");$("#"+e).remove(),$tabs.tabs("refresh"),autoSaveIntervalId[e]&&clearInterval(autoSaveIntervalId[e])}),$(document).keyup(function(e){try{switch(e.keyCode||e.which){case 46:$("#btn-delete-"+selectedTab.newPanel[0].id).click(),e.preventDefault();break;case 13:$("[name=quick-search-"+selectedTab.newPanel[0].id+"]").is(":focus")&&($("[name=selPage-"+selectedTab.newPanel[0].id+"] option:first").attr("selected","selected"),updateData(!1)),e.preventDefault();break;case 113:$("#btn-add-new-"+selectedTab.newPanel[0].id).click(),e.preventDefault();break;case 114:$("[name=quick-search-"+selectedTab.newPanel[0].id+"]").select(),e.preventDefault();break;case 115:toggleAllSelectedDataDetail(),e.preventDefault();break;case 116:$("#btn-refresh-"+selectedTab.newPanel[0].id).click(),e.preventDefault()}}catch(e){}}),$("#popup-panel .closebutton").on("click",function(){hideOverlayScreen()})}),this.customCodeHandler=function(e){var t=e.tabObj,a=t.find("[name=selCustomCode]"),n=t.find("[name=code]");e.customCodeCache[a.val()]=n.val(),a.change(function(){onCustomCodeChange(e,t)}),a.change(),n.change(function(){updateCustomCodeCache(e,t)})},this.updateCustomCodeCache=function(e,t){var a=t.find("[name=selCustomCode]"),n=t.find("[name=code]");e.customCodeCache[a.val()]=n.val()},this.onCustomCodeChange=function(e,t){var a=t.find("[name=selCustomCode]"),n=t.find("[name=code]"),i=a.val(),l="";$.ajax({type:"GET",url:"ajax-custom-code.php",asyn:!1,data:"action=getDataRowById&pkey="+i,success:function(t){if(t=(t=JSON.parse(t))[0],l=e.customCodeCache[i]?e.customCodeCache[i]:"",1==t.useautocode){var o=l||"[auto code]";n.val(o),n.prop("readonly",!0),a.closest("form").bootstrapValidator("revalidateField","code")}else"[auto code]"==l&&(l=""),n.val(l),n.prop("readonly",!1)}})};var multilineSelectmenu=$.widget("ui.multilineSelectmenu",$.ui.selectmenu,{_setText:function(e,t){if(t){if(-1!==t.indexOf("\n")){var a=t.split("\n");t='<span class="ui-selectmenu-menu-item-header">'+a[0].trim()+"</span>";for(var n=1;n<a.length;n++)t=t+'<span class="ui-selectmenu-menu-item-content">'+a[n].trim()+"</span>"}e.html(t)}else e.html("&#160;")}});jQuery.fn.animateAuto=function(e,t,a){var n,i;return this.each(function(l,o){o=jQuery(o),n=o.clone().css({height:"auto",width:"auto"}).appendTo("body"),i=n.height()-50,n.remove(),"height"===e&&o.animate({height:i},t,a)})};